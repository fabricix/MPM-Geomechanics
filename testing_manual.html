<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MPM-Geomechanics: Testing Compilation and Benchmarking</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="custom-html-style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">MPM-Geomechanics
   </div>
   <div id="projectbrief">Material Point Method for simulating geo-materials under large deformation conditions</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('testing_manual.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Testing Compilation and Benchmarking</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="testing_manual_howto_compile"></a>
1. How to Compile</h1>
<dl class="section note"><dt>Note</dt><dd>Prior to proceeding with these instructions, please consult the <a class="el" href="required_programs.html">Required Programs</a> section.</dd></dl>
<p>The tests use <b>GoogleTest</b>. It is necessary to import this library by cloning the official repository into the folder **<code>/external</code>**. Each developer must clone this repository independently.</p>
<div class="fragment"><div class="line">cd external</div>
<div class="line">git clone https://github.com/google/googletest.git</div>
</div><!-- fragment --><p>The simplest way to compile on Windows and Linux is by using the **<code>.bash</code>** file at **<code>/build/qa</code>** with **<code>MSYS2 MINGW64</code>** console line, simply execute the following command in the directory **<code>MPM-Geomechanics/build/qa</code>**: </p><div class="fragment"><div class="line">./cmake-build.bash</div>
</div><!-- fragment --><p>Alternatively, you can use the following commands: </p><div class="fragment"><div class="line">cmake -G &quot;Unix Makefiles&quot; -B build</div>
</div><!-- fragment --><div class="fragment"><div class="line">cmake --build build</div>
</div><!-- fragment --><p>These commands will generate two executables: **<code>MPM-Geomechanics-tests</code>** and **<code>MPM-Geomechanics-benchmark</code>**.</p>
<ul>
<li>**<code>MPM-Geomechanics-tests</code>**: Run testing using GoogleTest. All files ending with **<code>.test.cpp</code>** are testing files, you can find them in the directory **<code>qa/tests</code>**.</li>
<li>**<code>MPM-Geomechanics-benchmark</code>**: Run benchmark using GoogleTest. All files ending with **<code>.benchmark.cpp</code>** are performance files. You can find them in the directory **<code>qa/benchmark</code>**.</li>
</ul>
<h1><a class="anchor" id="testing_manual_howto"></a>
How does benchmarking work?</h1>
<dl class="section note"><dt>Note</dt><dd>If you are using <b>Windows OS</b>, make sure to use the <b>MINGW64 command-line console</b>.</dd></dl>
<h2><a class="anchor" id="testing_manual_howto_benchmark"></a>
Executable: MPM-Geomechanics-benchmark</h2>
<p>To run the benchmark correctly, a JSON file named **<code>benchmark-configuration.json</code>** is required. This file allows the user to specify values for each test. If the file does not exist or a value is missing, a default value will be used.</p>
<p>The executable **<code>MPM-Geomechanics-benchmark</code>** allows the following command-line arguments:</p>
<ul>
<li>**<code>&lt;directory&gt;</code>**: Specifies which file should be used to run the benchmark. If no file is specified, the program will use **<code>benchmark-configuration.json</code>** located in the same directory as the executable. Example: **<code>MPM-Geomechanics-benchmark configuration-file.json</code>**</li>
</ul>
<p>The executable **<code>MPM-Geomechanics-benchmark</code>** allows the following command-line flags:</p>
<ul>
<li>**<code>--log</code>**: Shows more information about missing keys in the **<code>benchmark-configuration.json</code>** file</li>
</ul>
<h2><a class="anchor" id="testing_manual_howto_multibenchmark"></a>
Executable: start-multi-benchmark.py</h2>
<p>The performance test can also be executed using the **<code>start-multi-benchmark.py</code>** script, which allows running benchmarks with one or more executables downloaded as artifacts from GitHub and stores the log results in separate folders. Each executable is automatically downloaded from GitHub as an artifact, using an ID specified in **<code>start-multi-benchmark-configuration.json</code>**. Additionally, the benchmark configuration (number of martial points and number of threads) can be defined in the same file.</p>
<p>Example of a **<code>start-multi-benchmark-configuration.json</code>** file:</p>
<div class="fragment"><div class="line">{</div>
<div class="line">    &quot;executables&quot;: {</div>
<div class="line">        &quot;win_benchmark_executable&quot;: &quot;MPM-Geomechanics-benchmark.exe&quot;,  -&gt; An executable located at build/qa/MPM-Geomechanics-benchmark.exe</div>
<div class="line">        &quot;win_github_id&quot;: &quot;17847226555&quot;  -&gt; An artifact ID that represent it. can check out if it exists via gh run view &lt;ID&gt;</div>
<div class="line">    },</div>
<div class="line">    &quot;parameters&quot;: {</div>
<div class="line">        &quot;particles&quot;: [ 15000, 25000, 50000],  -&gt; material point to test</div>
<div class="line">        &quot;threads&quot;: [1, 5, 10]  -&gt; number of threads to test</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --><p>As you can see, this setup will run 3x3 (particles x threads) tests for <b>win_benchmark_executable</b> and <b>win_github_id</b>, totaling 18 tests (3x3x2)</p>
<p>The executable **<code>start-multi-benchmark.py</code>** allows the following command-line flags:</p>
<ul>
<li>**<code>--clear</code>**: Removes the <b>benchmark folder</b> (if it exists) before executing the performance tests.</li>
<li>**<code>--cache</code>**: Uses the previously created cache instead of the **<code>start-multi-benchmark-configuration.json</code>** file. </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
